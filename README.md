<p align="center">
  í•œêµ­ì–´ | <a href="README.en.md">English</a>
</p>

# ğŸ¦´ Spine
<p align="center">
  <img src="assets/spine-logo.png" alt="Spine" width="420" />
</p>

**Spine is the execution backbone of a backend system.**

Spine defines **how a request is resolved, executed, and completed** â€” explicitly.

**SpineëŠ” ìš”ì²­ì´ ì–´ë–»ê²Œ ì‹¤í–‰ë˜ëŠ”ì§€ë¥¼ ê·¸ëŒ€ë¡œ ë“œëŸ¬ë‚´ëŠ” ë°±ì—”ë“œ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.**

---

# Spineì„ ì‰½ê²Œ ë°°ì›Œë³´ì„¸ìš”
Spineì˜ ì‹¤í–‰ êµ¬ì¡°ì™€ ì‚¬ìš© ë°©ë²•ì„ í•œëˆˆì— íŒŒì•…í•  ìˆ˜ ìˆëŠ” ê³µì‹ ì‚¬ì´íŠ¸ê°€ ì—´ë ¸ìŠµë‹ˆë‹¤.
[Spine ê³µì‹ ì‚¬ì´íŠ¸](https://spine.na2ru2.me/ko/)

## Spineì˜ ë¬¸ì œì˜ì‹

ëŒ€ë¶€ë¶„ì˜ ì›¹ í”„ë ˆì„ì›Œí¬ëŠ” ì‹¤í–‰ íë¦„ì„ ìˆ¨ê¹ë‹ˆë‹¤.

- ìš”ì²­ì´ ì–´ë””ì„œ ì‹œì‘ë˜ëŠ”ì§€
- ëˆ„ê°€ ì¸ìë¥¼ ìƒì„±í•˜ëŠ”ì§€
- ì–¸ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ì½”ë“œê°€ ì‹¤í–‰ë˜ëŠ”ì§€
- ë°˜í™˜ê°’ì´ ì–´ë–»ê²Œ ì‘ë‹µìœ¼ë¡œ ë³€í™˜ë˜ëŠ”ì§€

ì´ ëª¨ë“  ê³¼ì •ì€ í”„ë ˆì„ì›Œí¬ ë‚´ë¶€ ê·œì¹™ê³¼ ê´€ìŠµ, ì•”ë¬µì  ë™ì‘ì— ë¬»í˜€ ìˆìŠµë‹ˆë‹¤.

SpineëŠ” ì´ íë¦„ì„ ìˆ¨ê¸°ì§€ ì•ŠìŠµë‹ˆë‹¤.  
**ì‹¤í–‰ ìˆœì„œì™€ ì±…ì„ì„ ì½”ë“œ êµ¬ì¡°ë¡œ ê³ ì •**í•©ë‹ˆë‹¤.

---

## í•œêµ­ê³¼ Spine

í•œêµ­ì—ëŠ” ìì²´ IoC + ì‹¤í–‰ íŒŒì´í”„ë¼ì¸ êµ¬ì¡°ë¥¼ ê°€ì§„ ë°±ì—”ë“œ í”„ë ˆì„ì›Œí¬ê°€ ê±°ì˜ ì—†ìŠµë‹ˆë‹¤.  
ì „ìì •ë¶€ í”„ë ˆì„ì›Œí¬ì¡°ì°¨ Spring IoC ìœ„ì˜ ì¡°í•©ë¬¼ì— ê°€ê¹ìŠµë‹ˆë‹¤.

NestJS, Spring, FastAPI, DjangoëŠ” ëª¨ë‘ í•´ì™¸ ì„¤ê³„ ì² í•™ì˜ ìˆ˜ì…ì…ë‹ˆë‹¤.

SpineëŠ” í•œêµ­ì—ì„œ ê±°ì˜ ì²˜ìŒ ì‹œë„ë˜ëŠ”,  
**Execution Pipeline ì¤‘ì‹¬ì˜ í˜„ëŒ€ì ì¸ ë°±ì—”ë“œ í”„ë ˆì„ì›Œí¬**ì…ë‹ˆë‹¤.

---

## Spineìœ¼ë¡œ ë§Œë“  ì˜ˆì œ í”„ë¡œì íŠ¸

ğŸ‘‰ https://github.com/NARUBROWN/spine-user-demo

---

## Spineì€ ë¬´ì—‡ì´ ì•„ë‹Œê°€

- âŒ HTTP Engineì´ ì•„ë‹™ë‹ˆë‹¤
- âŒ Router ì¤‘ì‹¬ í”„ë ˆì„ì›Œí¬ê°€ ì•„ë‹™ë‹ˆë‹¤
- âŒ Annotation / Decorator ê¸°ë°˜ í”„ë ˆì„ì›Œí¬ê°€ ì•„ë‹™ë‹ˆë‹¤
- âŒ Convention over Configurationì„ ì±„íƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
- âŒ Controllerì— ì‹¤í–‰ ì±…ì„ì„ ìœ„ì„í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤

SpineëŠ” **Execution Pipeline**ì…ë‹ˆë‹¤.

---

## ì „ì²´ ì•„í‚¤í…ì²˜ ê°œìš”

```
HTTP Transport (Echo)
        â”‚
        â–¼
ExecutionContext
        â”‚
        â–¼
Pipeline
  â”œâ”€ Router
  â”œâ”€ ParameterMeta Builder
  â”œâ”€ ArgumentResolver Chain
  â”œâ”€ Interceptor (preHandle)
  â”œâ”€ Invoker (Controller Method Call)
  â”œâ”€ ReturnValueHandler
  â””â”€ Interceptor (postHandle)
        â”‚
        â–¼
ResponseWriter
```

ì´ êµ¬ì¡°ëŠ” ì„¤ì •ì´ ì•„ë‹ˆë¼ **ì‹¤í–‰ ëª¨ë¸ ê·¸ ìì²´**ì…ë‹ˆë‹¤.

---

## Execution Pipeline

ëª¨ë“  ìš”ì²­ì€ ë‹¤ìŒ ìˆœì„œë¥¼ **ë°˜ë“œì‹œ** ë”°ë¦…ë‹ˆë‹¤.

1. Pipeline ì§„ì…
2. Routerë¥¼ í†µí•œ HandlerMeta ì„ íƒ
3. ParameterMeta ìƒì„±
4. ArgumentResolver ì²´ì¸ ì‹¤í–‰
5. Interceptor.preHandle
6. Controller Method í˜¸ì¶œ (Invoker)
7. ReturnValueHandler ì‹¤í–‰
8. Interceptor.postHandle
9. ResponseWriterë¥¼ í†µí•œ ì‘ë‹µ ê¸°ë¡

ì´ ìˆœì„œëŠ” ìˆ¨ê²¨ì§€ì§€ ì•Šìœ¼ë©°, ì•”ë¬µì ìœ¼ë¡œ ë³€ê²½ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

---

## Controller ì„¤ê³„ ì² í•™

### Spineì˜ ì›ì¹™

> **ControllerëŠ” ì‹¤í–‰ ëª¨ë¸ì„ ëª¨ë¥¸ë‹¤.  
> í•˜ì§€ë§Œ ì…ë ¥ì˜ ì¶œì²˜ëŠ” íƒ€ì…ìœ¼ë¡œ ëª…ì‹œí•œë‹¤.**

ControllerëŠ” ë‹¤ìŒì— **ì˜ì¡´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤**:

- `path.*` : Path Parameter ì˜ë¯¸ íƒ€ì…
- `query.*` : Query Parameter ì˜ë¯¸ íƒ€ì…
- `httperr.*` : HTTP Error ì˜ë¯¸ íƒ€ì…

ControllerëŠ” ë‹¤ìŒì— **ì˜ì¡´í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤**:

- ExecutionContext
- Pipeline
- Router
- Resolver
- HTTP / Transport íƒ€ì…

---

### Controller ì˜ˆì‹œ

```go
func (c *UserController) GetUser(userId path.Int) (User, error) {
    if userId.Value <= 0 {
        return User{}, httperr.BadRequest("ìœ íš¨í•˜ì§€ ì•Šì€ ì‚¬ìš©ì IDì…ë‹ˆë‹¤")
    }

    user, err := c.repo.FindByID(userId.Value)
    if err != nil {
        return User{}, httperr.NotFound("ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤")
    }

    return user, nil
}
```

ControllerëŠ”:
- HTTPë¥¼ ëª¨ë¦…ë‹ˆë‹¤
- ì‹¤í–‰ ìˆœì„œë¥¼ ëª¨ë¦…ë‹ˆë‹¤
- ê°’ì˜ ì¶œì²˜ë§Œ ëª…ì‹œí•©ë‹ˆë‹¤

---

## Signature-as-Contract

Spineì—ì„œ **ë©”ì„œë“œ ì‹œê·¸ë‹ˆì²˜ëŠ” API ê³„ì•½ ê·¸ ìì²´**ì…ë‹ˆë‹¤.

- ì…ë ¥ ìƒì„± â†’ `ArgumentResolver`
- ì¶œë ¥ ì²˜ë¦¬ â†’ `ReturnValueHandler`

ì‹œê·¸ë‹ˆì²˜ ë³€ê²½ì€ ê³§ API ë³€ê²½ì…ë‹ˆë‹¤.

SpineëŠ” ë‹¤ìŒì„ ì˜ë„ì ìœ¼ë¡œ ê¸ˆì§€í•©ë‹ˆë‹¤:

- âŒ Annotation ê¸°ë°˜ ë§¤í•‘
- âŒ Convention ê¸°ë°˜ ìë™ ì¶”ë¡ 
- âŒ Primitive íƒ€ì…ì˜ ì•”ë¬µì  ì£¼ì…

---

## Context ë¶„ë¦¬

SpineëŠ” Contextë¥¼ ë‘ ê³„ì¸µìœ¼ë¡œ ë¶„ë¦¬í•©ë‹ˆë‹¤.

### ExecutionContext

- ì‹¤í–‰ íë¦„ ì œì–´ ì „ìš©
- Router / Pipeline ë‚´ë¶€ì—ì„œë§Œ ì‚¬ìš©
- Controller ë° Resolverì— ë…¸ì¶œ âŒ

### RequestContext

- ì…ë ¥ í•´ì„ ì „ìš© (Path / Query / Body)
- ArgumentResolverì—ì„œë§Œ ì‚¬ìš©
- Controllerì— ë…¸ì¶œ âŒ

---

## Path Parameter Binding Rule

Spineì˜ Path Parameter ë°”ì¸ë”©ì€ **ìˆœì„œ ê¸°ë°˜(order-based)** ì…ë‹ˆë‹¤.  
ì´ëŠ” Go ì–¸ì–´ ì œì•½ì„ ê³ ë ¤í•œ **ì˜ë„ì ì´ê³  ëª…ì‹œì ì¸ ê³„ì•½**ì…ë‹ˆë‹¤.

### ê·œì¹™

```
Route Path Key ì„ ì–¸ ìˆœì„œ
=
Controller ì‹œê·¸ë‹ˆì²˜ì˜ path.* íŒŒë¼ë¯¸í„° ì„ ì–¸ ìˆœì„œ
```

### ì˜ˆì‹œ

```go
// Route
/users/:userId/posts/:postId

// Controller
func GetPost(userId path.Int, postId path.Int)
```

### ì •ì±…

- ì´ë¦„ ë§¤ì¹­ âŒ
- annotation âŒ
- primitive íƒ€ì… âŒ
- ìˆœì„œ ë¶ˆì¼ì¹˜ ì‹œ ì¦‰ì‹œ ì‹¤íŒ¨ (Fail Fast)

---

## Query ì²˜ë¦¬ ì›ì¹™

### ì˜ë¯¸ê°€ ê³ ì •ëœ Query

```go
func ListUsers(p query.Pagination)
```

Spineê°€ ì œê³µí•˜ëŠ” ì˜ë¯¸ íƒ€ì…ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

### ê°€ë³€ Query

```go
func SearchUsers(q query.Values)
```

- Raw Query View ì œê³µ
- ì‚¬ìš©ìê°€ ì§ì ‘ í•´ì„
- DTO ìë™ ë§¤í•‘ âŒ

---

## ReturnValueHandler & ResponseWriter

ControllerëŠ” ê°’ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

```go
return User{...}
```

ì‘ë‹µ ìƒì„±ì€ ì „ë¶€ `ReturnValueHandler`ê°€ ë‹´ë‹¹í•©ë‹ˆë‹¤.  
TransportëŠ” `ResponseWriter`ë§Œ êµ¬í˜„í•©ë‹ˆë‹¤.

---

## License

MIT
